<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>OpenPlayer - demo</title>
    <meta name="description" content="OpenPlayer: the best simplified media player for modern browsers.">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link href="../css/bootstrap.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/font-awesome.min.css">
    <link href="../css/main.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/openplayer.min.css">
    <style>
        body {
            max-width: 700px;
        }
        select {
            margin-top: 20px;
        }
        select:last-child {
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <h1>OpenPlayer</h1>
    <div class="players">
        <h2>Video</h2>
        <video class="om-player om-player__media" controls playsinline data-om-options='{"hls": {"capLevelToPlayerSize": true} }'
            data-om-ads="https://pubads.g.doubleclick.net/gampad/ads?sz=640x480&iu=/124319096/external/ad_rule_samples&ciu_szs=300x250&ad_rule=1&impl=s&gdfp_req=1&env=vp&output=vmap&unviewed_position_start=1&cust_params=deployment%3Ddevsite%26sample_ar%3Dpremidpostoptimizedpod&cmsid=496&vid=short_onecue&correlator=">
            <source src="http://rmcdn.2mdn.net/Demo/vast_inspector/android.mp4" type="video/mp4">
        </video>
        <div>
            <label>Change source <select name="sources">
                <option value="http://rmcdn.2mdn.net/Demo/vast_inspector/android.mp4">MP4</option>
                <option value="http://ep-lin-upload.s3.amazonaws.com/vupl_lin/F64/CDF/F64CDF3B0348471E95C244DE2DDDD3F3">MP4 (no ext.)</option>
                <option value="https://upload.wikimedia.org/wikipedia/commons/2/22/Volcano_Lava_Sample.webm">WebM</option>
                <option value="https://video-dev.github.io/streams/x36xhzz/x36xhzz.m3u8">HLS</option>
                <option value="https://dash.akamaized.net/envivio/EnvivioDash3/manifest.mpd">M(PEG)-DASH</option>
            </select>
            </label>
            <button class="destroy-player">Destroy player</button>
            <button class="load-caption">Load caption</button>
        </div>
    </div>

    <div class="players">
        <h2>Audio</h2>
        <audio class="om-player om-player__media" controls>
            <source src="http://www.largesound.com/ashborytour/sound/AshboryBYU.mp3" type="audio/mp3">
        </audio>
        <div>
            <label>Change source <select name="sources">
                <option value="http://www.largesound.com/ashborytour/sound/AshboryBYU.mp3">MP3</option>
                <option value="http://db3.indexcom.com/bucket/ram/00/05/64k/05.m3u8">HLS</option>
            </select>
            </label>
            <button class="destroy-player">Destroy player</button>
            <button class="load-caption">Load caption</button>
        </div>
    </div>

    <script src="../js/openplayer.min.js"></script>
    <script>
        var sourcesSelector = document.querySelectorAll('select[name=sources]');
        var destroyBtn = document.querySelectorAll('button.destroy-player');
        var captionBtn = document.querySelectorAll('button.load-caption');
        
        function loadMedia() {
            var id = this.closest('.players').querySelector('.om-player').id;
            var player = OpenPlayer.instances[id];

            player.src = this.value.replace('&amp;', '&');
            player.load();
        }

        function destroyPlayer() {
            var id = this.closest('.players').querySelector('.om-player').id;
            var player = OpenPlayer.instances[id];
            player.destroy();
            this.removeEventListener('click', destroyPlayer);

            for (var i = 0, total = sourcesSelector.length; i < total; i++) {
                sourcesSelector[i].removeEventListener('change', loadMedia);
            }
        }

        function loadCaption() {
            var id = this.closest('.players').querySelector('.om-player').id;
            var player = OpenPlayer.instances[id];
            player.addCaptions({
                srclang: 'en_US',
                src: 'https://www.mediaelementjs.com/dist/mediaelement.vtt',
                kind: 'subtitles',
                label: 'English',
                default: true,
            });
            this.removeEventListener('click', loadCaption);
        }

        for (var i = 0, total = sourcesSelector.length; i < total; i++) {
            sourcesSelector[i].addEventListener('change', loadMedia);
        }

        for (var i = 0, total = destroyBtn.length; i < total; i++) {
            destroyBtn[i].addEventListener('click', destroyPlayer);
        }
        for (var i = 0, total = captionBtn.length; i < total; i++) {
            captionBtn[i].addEventListener('click', loadCaption);
        }
    </script>
</body>
</html>
